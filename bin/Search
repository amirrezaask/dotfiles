#!/usr/bin/bash
# searches for every symbol in your source code, symbol types can be f , sc , i , v

filename=`echo $samfile`

extension=`echo "${filename##*.}"`
if [ -z "$2" ]; then
	query_type='a'
else
	query_type="$2"
fi


# Add more languages :)

if [ "$extension" == 'go' ] | [ "$3" == 'go' ]; then
	f="func $1"
	sc="type $1 struct"
	i="type $1 interface"
	v="(var $1)|($1\s*:=)"
	extension_matched='1'
fi
if [ "$extension" = 'php' ] | [ "$3" == 'php' ]; then
	f="(?:public|private|protected)\s*(?:static)? ($1)\(.*\)"
	sc="(?:public|private|protected)\s*class\s*($1)"
	i="(?:public|private|protected)\s*interface\s*($1)"
	v='(?:public|private)?\$'
	v+="($1)\s*=.*;$"
	extension_matched='1'
fi


if [ $extension_matched == '1' ]; then
	cmd="rg -i --vimgrep"
	if [ $query_type == "f" ] || [ $query_type == "a" ]; then
		cmd+=" -e '$f'"
	fi

	if [ $query_type == "sc" ] || [ $query_type == "a" ]; then
		cmd+=" -e '$sc'"
	fi

	if [ $query_type == "i" ] || [ $query_type == "a" ]; then
		cmd+=" -e '$i'"
	fi

	if [ $query_type == "v" ] || [ $query_type == "a" ]; then
		cmd+=" -e '$v'"
	fi
	echo $cmd
	eval $cmd

fi
